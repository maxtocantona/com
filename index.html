<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Maxtocantona apps</title>
  <link rel="icon" type="image/png" href="maxtocantona.png">
  <link rel="shortcut icon" href="maxtocantona.png" type="image/png">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="all apps MaxtoCantona. You can find it here.">
<style>
  body {
    font-family: sans-serif;
    background: #f8f9fa;
    padding: 20px;
  }
  h2 {
    text-align: center;
    margin-bottom: 30px;
  }
  .app-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    padding: 16px;
    margin-bottom: 20px;
    transition: transform 0.2s, border 0.3s;
    border: 2px solid transparent;
  }
  .app-card:hover {
    transform: scale(1.02);
  }
  .app-card.focused {
    border: 2px solid red;
  }
  @keyframes pulse {
    0%   { box-shadow: 0 0 15px 3px #11ff66; }
  50%  { box-shadow: 0 0 35px 15px #2575fc; }
  100% { box-shadow: 0 0 50px 25px #ff00ff; }
  }
  .app-content {
    display: flex;
    align-items: center;
    text-decoration: none;
    color: inherit;
  }
  .app-card img {
    width: 64px;
    height: 64px;
    border-radius: 12px;
    margin-right: 15px;
    object-fit: cover;
  }
  .app-card h3 {
    margin: 0;
    font-size: 18px;
  }
  .download-count {
    margin-top: 8px;
    font-size: 14px;
    color: #444;
  }
</style>
</head>
<body>
<h2>All apps</h2>
<div id="app-list"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyCPYQs_cTU5trpelLBB1D51YbdQSsVILZA",
  authDomain: "molten-turbine-447909-m3.firebaseapp.com",
  databaseURL: "https://molten-turbine-447909-m3-default-rtdb.firebaseio.com",
  projectId: "molten-turbine-447909-m3",
  storageBucket: "molten-turbine-447909-m3.firebasestorage.app",
  messagingSenderId: "607843677651",
  appId: "1:607843677651:web:a6cc228585c6c2e29a6b26"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

function formatCount(count){
  if(count >= 1_000_000_000) return Math.floor(count/1_000_000_000)+"B+";
  if(count >= 1_000_000) return Math.floor(count/1_000_000)+"M+";
  if(count >= 1_000) return Math.floor(count/1_000)+"K+";
  return count.toString();
}
function toHex(str){
  return [...str].map(c=>c.charCodeAt(0).toString(16)).join('');
}

// Apps array with multiple photos
const apps = [
  {
    id:"EfutCards",
    name:"EfutCards",
    apk:"EfutCards_v.1.7.apk",
    description:"With this app you can create high-quality efootball-like cards.",
    image:"efut.png",
    photos:["efut1.png","efut2.png","efut3.png"]
  }
  
];

const container = document.getElementById("app-list");
const urlParams = new URLSearchParams(window.location.search);
let focusedAppId = urlParams.get('focus') || null;

apps.forEach(app=>{
  const hexDes = toHex(app.description);
  const href = `download.html?app=${encodeURIComponent(app.apk)}&png=${encodeURIComponent(app.image)}&des=${hexDes}&appId=${app.id}&photos=${encodeURIComponent(JSON.stringify(app.photos))}`;

  const div = document.createElement("div");
  div.className = "app-card";
  div.innerHTML = `
    <a href="#" class="app-content">
      <img src="${app.image}" alt="${app.name}" onerror="this.src='default-icon.png'">
      <div>
        <h3>${app.name}</h3>
        <div class="download-count" id="count-${app.id}">Downloads: ...</div>
      </div>
    </a>
  `;
  container.appendChild(div);

  // Initial focus
  if(focusedAppId && focusedAppId === app.id){
    div.classList.add("focused");
    div.scrollIntoView({behavior:"smooth", block:"center"});
  }

  // Click handler
  div.querySelector(".app-content").addEventListener("click", e=>{
    e.preventDefault();
    if(focusedAppId === app.id){
      // Already focused â†’ open download page
      window.location.href = href;
    } else {
      // Focus change
      const prev = document.querySelector(".app-card.focused");
      if(prev) prev.classList.remove("focused");
      div.classList.add("focused");
      focusedAppId = app.id;
      div.scrollIntoView({behavior:"smooth", block:"center"});

      // Update URL query parameter without refreshing
      const newUrl = window.location.pathname + '?focus=' + encodeURIComponent(app.id);
      history.replaceState(null, '', newUrl);
    }
  });

  // Firebase download count
  const countRef = ref(db,"downloads/"+app.id);
  onValue(countRef, snapshot=>{
    const count = snapshot.val()||0;
    document.getElementById("count-"+app.id).innerText = "Downloads: "+formatCount(count);
  });
});
</script>
</body>
</html>
